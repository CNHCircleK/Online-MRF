var mongo = require('mongodb');
var ObjectId = mongo.ObjectId;
var mongoSanitize = require('express-mongo-sanitize');

module.exports = function(app){
	var functions = {
		checkIn: function(json, fields, callback){
			fields.forEach(function(elem){
				if(!(elem in json)){
					callback(elem, false);
				} else{
					callback(elem, true);
				}
			});
		},
		parseJSON: function(item) {
		    item = typeof item !== "string"
		        ? JSON.stringify(item)
		        : item;

		    try {
		        item = JSON.parse(item);
		    } catch (e) {
		        return false;
		    }

		    if (typeof item === "object" && item !== null) {
		        return item;
		    }
		    return false;
		},

		parseArray: function(item) {
		    var json = functions.parseJSON(item);
		    return Array.isArray(json) ? json : false;
		}
	}

	return functions;
}